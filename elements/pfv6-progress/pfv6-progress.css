*,
*::before,
*::after {
  box-sizing: border-box;
}

:host {
  /* Component variables */
  --pf-v6-c-progress--GridGap: var(--pf-t--global--spacer--md, 1rem);

  /* Element variables */
  --pf-v6-c-progress__bar--Height: var(--pf-t--global--spacer--md, 1rem);
  --pf-v6-c-progress__bar--BackgroundColor:
    var(
      --pf-t--global--color--nonstatus--gray--default,
      #e0e0e0
    );
  --pf-v6-c-progress__bar--BorderRadius:
    var(
      --pf-t--global--border--radius--medium,
      16px
    );
  --pf-v6-c-progress__bar--BorderColor:
    var(
      --pf-t--global--border--color--high-contrast,
      rgb(255 255 255 / 0%)
    );
  --pf-v6-c-progress__bar--BorderWidth:
    var(
      --pf-t--global--border--width--high-contrast--regular,
      0px
    );
  --pf-v6-c-progress__measure--m-static-width--MinWidth: 4.5ch;
  --pf-v6-c-progress__status--Gap: var(--pf-t--global--spacer--sm, 0.5rem);
  --pf-v6-c-progress__status-icon--Color:
    var(
      --pf-t--global--icon--color--regular,
      #1f1f1f
    );
  --pf-v6-c-progress__indicator--Height:
    var(
      --pf-v6-c-progress__bar--Height
    );
  --pf-v6-c-progress__indicator--BackgroundColor:
    var(
      --pf-t--global--color--brand--default,
      #0066cc
    );
  --pf-v6-c-progress__indicator--BorderWidth:
    var(
      --pf-t--global--border--width--high-contrast--extra-strong,
      0px
    );
  --pf-v6-c-progress__indicator--BorderColor: transparent;
  --pf-v6-c-progress__helper-text--MarginBlockStart:
    calc(
      var(--pf-t--global--spacer--sm, 0.5rem) - var(--pf-v6-c-progress--GridGap)
    );

  /* Modifier variables */
  --pf-v6-c-progress--m-success__indicator--BackgroundColor:
    var(
      --pf-t--global--color--status--success--default,
      #3d7317
    );
  --pf-v6-c-progress--m-warning__indicator--BackgroundColor:
    var(
      --pf-t--global--color--status--warning--default,
      #ffcc17
    );
  --pf-v6-c-progress--m-danger__indicator--BackgroundColor:
    var(
      --pf-t--global--color--status--danger--default,
      #b1380b
    );
  --pf-v6-c-progress--m-success__status-icon--Color:
    var(
      --pf-t--global--icon--color--status--success--default,
      #3d7317
    );
  --pf-v6-c-progress--m-warning__status-icon--Color:
    var(
      --pf-t--global--icon--color--status--warning--default,
      #dca614
    );
  --pf-v6-c-progress--m-danger__status-icon--Color:
    var(
      --pf-t--global--icon--color--status--danger--default,
      #b1380b
    );
  --pf-v6-c-progress--m-inside__indicator--MinWidth:
    var(
      --pf-t--global--spacer--xl,
      2rem
    );
  --pf-v6-c-progress--m-inside__measure--Color:
    var(
      --pf-t--global--text--color--on-brand--default,
      #ffffff
    );
  --pf-v6-c-progress--m-success--m-inside__measure--Color:
    var(
      --pf-t--global--text--color--status--on-success--default,
      #ffffff
    );
  --pf-v6-c-progress--m-warning--m-inside__measure--Color:
    var(
      --pf-t--global--text--color--status--on-warning--default,
      #151515
    );
  --pf-v6-c-progress--m-danger--m-inside__measure--Color:
    var(
      --pf-t--global--text--color--status--on-danger--default,
      #ffffff
    );
  --pf-v6-c-progress--m-inside__measure--FontSize:
    var(
      --pf-t--global--font--size--sm,
      0.875rem
    );
  --pf-v6-c-progress--m-outside__measure--FontSize:
    var(
      --pf-t--global--font--size--sm,
      0.875rem
    );
  --pf-v6-c-progress--m-sm__bar--Height:
    var(
      --pf-t--global--spacer--sm,
      0.5rem
    );
  --pf-v6-c-progress--m-sm__measure--FontSize:
    var(
      --pf-t--global--font--size--body--sm,
      0.75rem
    );
  --pf-v6-c-progress--m-lg__bar--Height:
    var(
      --pf-t--global--spacer--lg,
      1.5rem
    );

  display: block;
}

#container {
  display: grid;
  grid-template-rows: 1fr auto;
  grid-template-columns: auto auto;
  grid-gap: var(--pf-v6-c-progress--GridGap);
  align-items: end;

  /* Base element styles - must come before modifiers for specificity */
  & .title {
    grid-column: 1 / 2;
    overflow-wrap: break-word;

    &.truncate {
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
  }

  & .status {
    display: flex;
    grid-row: 1 / 2;
    grid-column: 2 / 3;
    gap: var(--pf-v6-c-progress__status--Gap);
    align-items: flex-start;
    justify-content: flex-end;
    text-align: end;
    overflow-wrap: break-word;
  }

  & .status-icon {
    color: var(--pf-v6-c-progress__status-icon--Color);
  }

  & .measure {
    font-variant-numeric: tabular-nums;
  }

  /* Size modifiers */
  &.sm {
    --pf-v6-c-progress__bar--Height:
      var(
        --pf-v6-c-progress--m-sm__bar--Height
      );

    & .measure {
      font-size: var(--pf-v6-c-progress--m-sm__measure--FontSize);
    }
  }

  &.lg {
    --pf-v6-c-progress__bar--Height:
      var(
        --pf-v6-c-progress--m-lg__bar--Height
      );
  }

  /* Inside style - measure inside the indicator */
  &.inside {
    & pfv6-progress-bar {
      --_progress-bar-indicator-display: flex;
      --_progress-bar-indicator-align-items: center;
      --_progress-bar-indicator-justify-content: center;
      --_progress-bar-indicator-min-width:
        var(
          --pf-v6-c-progress--m-inside__indicator--MinWidth
        );
      --_progress-bar-measure-font-size:
        var(
          --pf-v6-c-progress--m-inside__measure--FontSize
        );
      --_progress-bar-measure-color:
        var(
          --pf-v6-c-progress--m-inside__measure--Color
        );
      --_progress-bar-measure-text-align: center;
    }
  }

  /* Outside style - measure and status icon to the right of the bar */
  &.outside {
    grid-template-columns: 1fr fit-content(50%);

    & .title {
      grid-column: 1 / 3;
    }

    & .status {
      grid-row: 2 / 3;
      grid-column: 2 / 3;
      align-self: center;
    }

    & .measure {
      display: inline-block;
      font-size: var(--pf-v6-c-progress--m-outside__measure--FontSize);

      &.static-width {
        min-width:
          var(
            --pf-v6-c-progress__measure--m-static-width--MinWidth
          );
        text-align: start;
      }
    }

    & pfv6-progress-bar {
      --_progress-bar-grid-column: 1 / 2;
    }
  }

  /* No title - single line layout */
  &.singleline {
    grid-template-rows: 1fr;
    grid-template-columns: 1fr fit-content(50%);

    & .title {
      display: none;
    }

    & pfv6-progress-bar {
      --_progress-bar-grid-row: 1 / 2;
      --_progress-bar-grid-column: 1 / 2;
    }

    & .status {
      grid-row: 1 / 2;
      grid-column: 2 / 3;
    }
  }

  /* Status modifiers */
  &.success {
    --pf-v6-c-progress__indicator--BackgroundColor:
      var(
        --pf-v6-c-progress--m-success__indicator--BackgroundColor
      );
    --pf-v6-c-progress__status-icon--Color:
      var(
        --pf-v6-c-progress--m-success__status-icon--Color
      );
    --pf-v6-c-progress--m-inside__measure--Color:
      var(
        --pf-v6-c-progress--m-success--m-inside__measure--Color
      );
  }

  &.warning {
    --pf-v6-c-progress__indicator--BackgroundColor:
      var(
        --pf-v6-c-progress--m-warning__indicator--BackgroundColor
      );
    --pf-v6-c-progress__status-icon--Color:
      var(
        --pf-v6-c-progress--m-warning__status-icon--Color
      );
    --pf-v6-c-progress--m-inside__measure--Color:
      var(
        --pf-v6-c-progress--m-warning--m-inside__measure--Color
      );
  }

  &.danger {
    --pf-v6-c-progress__indicator--BackgroundColor:
      var(
        --pf-v6-c-progress--m-danger__indicator--BackgroundColor
      );
    --pf-v6-c-progress__status-icon--Color:
      var(
        --pf-v6-c-progress--m-danger__status-icon--Color
      );
    --pf-v6-c-progress--m-inside__measure--Color:
      var(
        --pf-v6-c-progress--m-danger--m-inside__measure--Color
      );

    & pfv6-progress-bar {
      @media (prefers-reduced-motion: no-preference) {
        --_progress-bar-translate:
          var(
            --pf-v6-global--danger-jiggle--TranslateX,
            0
          );
        --_progress-bar-animation-name: pf-v6-global-danger-jiggle-motion;
        --_progress-bar-animation-duration:
          var(
            --pf-v6-global--danger-jiggle--AnimationDuration--Transform,
            var(--pf-t--global--motion--duration--fade--default, 200ms)
          );
        --_progress-bar-animation-timing-function:
          var(
            --pf-v6-global--danger-jiggle--AnimationTimingFunction--Transform,
            var(
              --pf-t--global--motion--timing-function--default,
              cubic-bezier(0.4, 0, 0.2, 1)
            )
          );
        --_progress-bar-animation-fill-mode: both;
      }
    }

    & .status-icon {
      animation-name: pf-v6-global-fade-in;
      animation-duration:
        var(
          --pf-v6-c-progress__status-icon--TransitionDuration--Opacity,
          var(--pf-t--global--motion--duration--fade--default, 200ms)
        );
      animation-timing-function:
        var(
          --pf-v6-c-progress__status-icon--TransitionTimingFunction--Opacity,
          var(
            --pf-t--global--motion--timing-function--default,
            cubic-bezier(0.4, 0, 0.2, 1)
          )
        );
    }
  }
}

/* Keyframe animations */
@keyframes pf-v6-global-danger-jiggle-motion {
  33% {
    --pf-v6-global--danger-jiggle--TranslateX: -2px;
  }

  66% {
    --pf-v6-global--danger-jiggle--TranslateX: 3px;
  }
}

@keyframes pf-v6-global-fade-in {
  from {
    opacity: 0;
  }

  to {
    opacity: 1;
  }
}
